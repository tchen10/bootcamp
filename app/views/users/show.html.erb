<title>Dashboard</title>
  <div class="span12">
    <h1><%= @user.name %></h1>
  </div>

  <div class = "well span4">
    <p>
      <b>Email:</b>
      <%= @user.email %>
    </p>

    <p>
      <b>Home:</b>
      <%= @user.home %>
    </p>

    <p>
      <b>Birthday:</b>
      <%= @user.birthday %>
    </p>

    <p>
      <b>Bio:</b>
      <%= @user.bio %>
    </p>

    <p>
      <%= link_to 'Edit', edit_user_url(@user.id), :class => "btn btn-mini" %> <%= link_to 'Delete User', user_url(@user.id), :class => "btn btn-mini", method: 'delete', data: { confirm: "Do you really want to delete this user?" } %>
    </p>
  </div>

  <div class= "span10">
    <div class="well">
      <h4><b>My Tasks:</b></h4>
      <table class="table table-hover">
      <thead>
        <tr>
          <th>Description</th>
          <th>Due Date</th>
          <th>Milestone</th>
          <th>Project</th>
          <th>Status</th>
          <th>Update</th>
        </tr>
      </thead>
      <tbody>
      <% @user.tasks.incomplete.order('due_date').all.each do |task| %>
        <% if task.due_date <= Date.today %>
          <tr class="error">
        <% else %>
          <tr>
        <% end %>
          <td><%= link_to task.description, task_url(task.id) %></td>
          <td><%= task.due_date %></td>
          <td><%= link_to task.milestone.title, milestone_url(task.milestone.id) %></td>
          <td><%= link_to task.milestone.project.title, project_url(task.milestone.project.id) %></td>
          <td><%= task.status %></td>
          <%= form_tag(task_url(task.id), method: 'put', :class => "form-inline") do %>
                  <%= hidden_field_tag :project_id, task.project_id %>
                  <%= hidden_field_tag :milestone_id, task.milestone.id %>
                  <%= hidden_field_tag :description, task.description %>
                  <div id="divdateselect" style="display: none;">
                    <%= date_select :date_created, :date_created, :default => task.date_created, :order => [:day, :month, :year], :start_year => Time.now.year, :end_year => Time.now.year+2 %>
                  <%= date_select :due_date, :due_date, :default => task.due_date, :order => [:day, :month, :year], :start_year => Time.now.year, :end_year => Time.now.year+2 %>
                   <%= date_select :date_completed, :date_completed, :default => Date.today, :order => [:day, :month, :year], :start_year => Time.now.year, :end_year => Time.now.year+2 %>
                  </div>
                  <%= hidden_field_tag :user_id, task.user_id %>
                  <td><%= text_field_tag :status, nil, :placeholder => "Status?", :class => "input-mini" %>
                  <%= hidden_field_tag :complete, "incomplete" %>
                  <%= check_box_tag :complete, "complete", false %>
                  <%= submit_tag "Update", :class => "btn btn-mini" %>
                  <% end %>
                  </td>
          <td><%= link_to 'Edit', edit_task_url(task), :class => "btn btn-mini" %></td>
          </tr>
          <% end %>
          </tbody>
      </table>
    </div>
    <div class="well">
        <h4><b>My Projects:</b></h4>
        <table class = "table table-hover">
          <thead>
            <tr>
              <th>Title</th>
              <th>Team</th>
              <th>Due date</th>
              <th>Status</th>
              <th>Last Update</th>
            </tr>
          </thead>

      <tbody>
      <% @user.projects.order('due_date').all.each do |project| %>
        <tr>
          <td><%= link_to project.title, project_url(project) %></td>
          <td><% project.users.each do |user| %>
          <p><%= link_to user.name, user_url(user) %><p>
          <% end %></td>
          <td><%= project.due_date %></td>
          <% if project.recent_status.present? %>
            <td><%= project.recent_status.description %></td>
            <td><%= project.recent_status.date %></td>
          <% else %>
            <td></td>
            <td></td>
          <% end %>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>

  <div class="well">
    <h4><b>Completed Tasks:</b></h4>
      <table class="table table-hover">
    <thead>
      <tr>
        <th>Description</th>
        <th>Due Date</th>
        <th>Milestone</th>
        <th>Project</th>
        <th>Date Completed</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
    <% @user.tasks.complete.order('due_date').all.each do |task| %>
      <tr>
        <td><%= link_to task.description, task_url(task.id) %></td>
        <td><%= task.due_date %></td>
        <td><%= link_to task.milestone.title, milestone_url(task.milestone.id) %></td>
        <td><%= link_to task.milestone.project.title, project_url(task.milestone.project.id) %></td>
        <td><%= task.date_completed %></td>

        <td><%= link_to 'Delete', task_url(task), :class => "btn btn mini", method: 'delete', data: { confirm: "Do you really want to delete this task?" } %></td>

      </tr>
    <% end %>
    </tbody>
  </div>




