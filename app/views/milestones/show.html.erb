
  <div class="span12">
    <h1><%= @milestone.project.title %>: <%= @milestone.title %></h1>
  </div>

  <div class="span4">

    <div class="well">
      <p>
        <b>Description:</b>
        <%= @milestone.description %>
      </p>

      <p>
        <b>Date created:</b>
        <%= @milestone.date_created %>
      </p>

      <p>
        <b>Due date:</b>
        <%= @milestone.due_date %>
      </p>

      <p>
        <%= link_to "Edit", edit_milestone_url(@milestone.id), :class => "btn btn-mini" %> <%= link_to 'Delete Milestone', milestone_url(@milestone.id), :class => "btn btn-mini", method: 'delete', data: { confirm: "Do you really want to delete this milestone?" } %>
      </p>
    </div>

    <div class="well">
      <p>
        <b>Project Details:</b>
      <p><%= link_to @milestone.project.title, project_url(@milestone.project_id) %></p>
      </p>

      <p>
        <b>Due date:</b>
        <%= @milestone.project.due_date %>
      </p>

      <p>
        <b>Description:</b>
        <%= @milestone.project.description %>
      </p>

      <p>
        <b>Team:</b>
        <ul>
          <% @milestone.project.users.each do |user| %>
            <li><%= link_to user.name, user_url(user) %></li>
          <% end %>
        </ul>
      </p>
    </div>
  </div>
  <div class="span10">
    <div class="well">
      <h4><b>Tasks:</b></h4>
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Description</th>
            <th>Due date</th>
            <th>Assigned</th>
            <th>Status</th>
            <th>Last Update</th>
            <th>Complete?</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
        <% @milestone.tasks.incomplete.order('due_date').all.each do |task| %>
          <% if task.due_date <= Date.today %>
            <tr class="error">
          <% else %>
            <tr>
          <% end %>
            <td><%= link_to task.description, task_url(task.id) %></td>
            <td><%= best_in_place task, :due_date, :type => :date %></td>
            <td><%= link_to task.user.name, user_url(task.user.id) %></td>
            <td><%= best_in_place task, :status %></td>
            <td><%= task.date_completed %></td>
            <td><%= best_in_place task, :complete, :type => :select, :collection => [["incomplete", "Nope"], ["complete", "Yep!"]] %></td>
            <td><%= link_to 'Edit', edit_task_url(task), :class => "btn btn-mini" %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
      <p><button class="btn btn-success", data-toggle="collapse", data-target="#quick_form">+</button></p>
      <div id="quick_form", class="collapse">
        <% @task = Task.new %>
        <%= form_for @task do |f| %>
        <%= f.hidden_field :project_id, :value => @milestone.project.id %>
        <%= f.hidden_field :milestone_id, :value => @milestone.id %>
        <div class="span5">
          <%= f.text_field :description, :placeholder => "Description" %>
        </div>
        <div id="divdateselect" style="display: none;">
          <%= f.date_select :date_created, default:Date.today %>
          <%= f.date_select :date_completed, default:Date.today %>
        </div>
        <div class="span5">
          <%= f.label :due_date, "Due Date:" %>
          <%= f.date_select :due_date, :default => Date.today+1, :order => [:day, :month, :year], :start_year => Time.now.year, :end_year => Time.now.year+2 %>
        </div>
        <div class="span5">
        <%= f.label :user_id, "Assigned To:" %>
        <%= f.collection_select :user_id, User.order('name').all, :id, :name %>
        </div>
        <%= f.hidden_field :status, :value => "Update Status!" %>
        <%= f.hidden_field :complete, :value => "incomplete" %>
        <div class="span5">
        <%= f.submit "Create Task", :class => "btn btn-mini" %>
        </div>
        <% end %>
    </div>
  </div>

  <div class="well">
    <h4><b>Completed Tasks:</b></h4>
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Description</th>
          <th>Due Date</th>
          <th>Milestone</th>
          <th>Date Completed</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <% @milestone.tasks.complete.order('due_date').all.each do |task| %>
        <tr>
          <td><%= link_to task.description, task_url(task.id) %></td>
          <td><%= task.due_date %></td>
          <td><%= link_to task.milestone.title, milestone_url(task.milestone.id) %></td>
          <td><%= task.date_completed %></td>
          <td><%= link_to 'Delete', task_url(task), :class => "btn btn-mini", method: 'delete', data: { confirm: "Do you really want to delete this task?" } %></td>
        </tr>
        <% end %>
    </tbody>
  </table>
  </div>
</div>

